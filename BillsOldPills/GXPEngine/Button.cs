using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using GXPEngine;
public class Button : AnimationSprite
{
    private bool _isActivated = false;
    private List<Door> _doors;
    private List<Sprite> _sprite;


    //------------------------------------------------------------------------------------------------------------
    //                                                  Constructor
    //------------------------------------------------------------------------------------------------------------
    public Button(int newFrame, int newWidth, int newHeight) : base("SpriteSheet.png", 10, 7)
    {
        SetFrame(newFrame);
        this.width = newWidth;
        this.height = newHeight;
        _doors = new List<Door>();
        _sprite = new List<Sprite>();
    }
    //------------------------------------------------------------------------------------------------------------
    //                                                 Update
    //------------------------------------------------------------------------------------------------------------
    void Update()
    {
        handleButton();
    }
    //------------------------------------------------------------------------------------------------------------
    //                                                 handleButton
    //------------------------------------------------------------------------------------------------------------
    private void handleButton()
    {
        foreach (Sprite sprite in _sprite)
        {
            if (sprite.HitTest(this))
            {
                activate();
                break;
            }
            else
            {
                deactivate();
            }
        }
    }
    //------------------------------------------------------------------------------------------------------------
    //                                                 activate
    //------------------------------------------------------------------------------------------------------------

    private void activate()
    {

        if (_isActivated == false)
        {
            openDoors();
            _isActivated = true;
            currentFrame++;

        }
    }
    //------------------------------------------------------------------------------------------------------------
    //                                                 deactivate
    //------------------------------------------------------------------------------------------------------------

    private void deactivate()
    {

        if (_isActivated == true)
        {
            _isActivated = false;
            currentFrame--;
            closeDoors();
        }
    }
    //------------------------------------------------------------------------------------------------------------
    //                                                 openDoors
    //------------------------------------------------------------------------------------------------------------
    private void openDoors()
    {
        foreach (Door door in _doors)
        {
            door.Open();
        }
    }
    //------------------------------------------------------------------------------------------------------------
    //                                                 closeDoors
    //------------------------------------------------------------------------------------------------------------
    private void closeDoors()
    {

        foreach (Door door in _doors)
        {
            door.Close();
        }
    }

    //------------------------------------------------------------------------------------------------------------
    //                                                 AssignDoors
    //------------------------------------------------------------------------------------------------------------
    public void AssignDoor(Door door)
    {
        _doors.Add(door);
    }
    //------------------------------------------------------------------------------------------------------------
    //                                                 SetObjectList
    //------------------------------------------------------------------------------------------------------------

    public void SetObjectList(List<Sprite> objectList)
    {
        _sprite = objectList;
    }

}